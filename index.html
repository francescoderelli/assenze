<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Presenze 2025 → Report ore annue</title>
  <meta name="description" content="Carica Presenze_Base.xlsx, valida il file e genera il report Excel con ore annue e percentuali presenza." />
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <main class="wrap">
    <header class="hero">
      <div class="hero-top">
        <div class="badge">v1.0 stable</div>
        <h1>Presenze 2025 → Report ore annue</h1>
        <p class="sub">
          Carica <b>Presenze_Base.xlsx</b>. La pagina controlla la struttura del file e poi genera l’Excel con pivot e percentuali.
        </p>
      </div>

      <div class="how">
        <div class="how-title">Come estrarre il file (zero dubbi)</div>
        <ol class="how-list">
          <li>Andate su <b>Dashboard → Timesheets &amp; Materials Summary (Riepilogo Ore &amp; Materiali)</b></li>
          <li>Aprite la tab <b>Rilevamento presenze</b></li>
          <li>Impostate i filtri su <b>Anno = 2025</b> (tutti i mesi) e <b>la vostra sede</b></li>
          <li>Esportate/Scaricate il file con <b>tutte le ore da gennaio a dicembre 2025</b></li>
        </ol>
      </div>
    </header>

    <section class="card">
      <div class="row">
        <label class="label" for="filePresenze">Carica Presenze_Base.xlsx</label>
        <input id="filePresenze" class="file" type="file" accept=".xlsx" />
      </div>

      <div id="status" class="status"></div>

      <div class="checks-title">Controlli</div>
      <div id="checks" class="checks">
        <div>Carica il file per avviare la validazione.</div>
      </div>

      <div class="actions">
        <button id="btnRun" class="btn" disabled>Genera Excel</button>
      </div>

      <div class="hint">
        Output: <b>Ore_Annue_per_Risorsa_e_Tipologia.xlsx</b> (download automatico).<br/>
        Nota: eventuali causali non mappate vengono trattate come <b>presenza</b> (warning).
      </div>
    </sec
